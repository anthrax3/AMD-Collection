<!doctype html>
<head>
	<title>Asserter Module Test Suite</title>

	<link rel="stylesheet" href="lib/qunit.css" type="text/css" media="screen">
	<script src="lib/qunit.js"></script>
	<script src="lib/sinon.js"></script>
	<script src="lib/require.js"></script>
	<script src="lib/testing.js"></script>

	<script>
		QUnit.config.testTimeout = 2000;

		var assertIsExpected = function( fn, notFn, name, exp ){
			for ( var i = 0, l = exp.length; i < l; i += 1 ){
				var msg = exp[ i ].test + ' is ' + ( exp[ i ].val ? '' : 'not' ) + ' a ' + name;
				strictEqual( fn( exp[ i ].test ), exp[ i ].val, msg );
				strictEqual( notFn( exp[ i ].test ), ! exp[ i ].val, '...and assert.is.not.<type> returns ' + ( notFn( exp[ i ].test ) ? 'true' : 'false' ) );
			}
			expect( exp.length * 2 );
		};

		test('test are running in a compatible environment', function(){
			notStrictEqual( window.location.protocol, 'file:', 'Not running tests under the "file:" protocol' );
		});

		module( 'With a new RequireJS context and sinon sandbox :', {
			setup: function(){
				testing.setupAndTeardown.setup();
			},
			teardown: function(){
				testing.setupAndTeardown.teardown();
			}
		});

		var findChildren = function( obj, fn ){
			for ( var prop in obj ){
				fn( prop, obj[ prop ] );
				if ( typeof obj[ prop ] === 'object' ){
					findChildren( obj[ prop ], fn );
				}
			}
		};

		test('confirm module methods & properties', function(){
			testing.req.given( [ 'src/asserter' ], function ( module ) {
				var expected = {
					is: 'object',
					not: 'object',
					bool: 'function',
					string: 'function',
					emptyString: 'function',
					number: 'function',
					object: 'function',
					array: 'function',
					fn: 'function',
					method: 'function',
					property: 'function',
					undefined: 'function',
					null: 'function',
					nullOrUndefined: 'function',
					NaN: 'function'
				};

				findChildren( module, function( key, val ){
					strictEqual( typeof val, expected[ key ], 'module includes the "' + key + '" method / property' );
				});

				expect( Object.keys( expected ).length * 2 - 2 ); // all methods are available under .is and .is.not namespaces, whereas .is and .not themselves are unique
			});
		});

		test('when calling .is.<type>()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;

				ok( assert.is.bool( true ), '.bool( true ) returns true' );
				ok( assert.is.string( 'foo' ), '.string( \'foo\' ) returns true' );
				ok( assert.is.number( 666 ), '.number( 13 ) returns true' );
				ok( assert.is.object( {} ), '.object( {} ) returns true' );
				ok( assert.is.array( [] ), '.array( [] ) returns true' );
				ok( assert.is.fn( function(){} ), '.fn( function(){} ) returns true' );
				ok( assert.is.method( function(){} ), '.method( function(){} ) returns true' );
				ok( assert.is.property( 'bar' ), '.property( < anything except a function > ) returns true' );
				ok( assert.is.undefined( undef ), '.undefined() returns true' );
				ok( assert.is.null( null ), '.null( null ) returns true' );
				ok( assert.is.nullOrUndefined( null ), '.nullOrUndefined( < null / undefined > ) returns true' );
				ok( assert.is.NaN( parseInt( 'fssh' ) ), '.NaN( parseInt( \'fssh\' ) ) returns true' );
			});
		});

		test('when calling .is.bool() and .is.not.bool()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: true, val: true },
					{ test: false, val: true },
					{ test: 'foo', val: false },
					{ test: '', val: false },
					{ test: 0, val: false },
					{ test: 1, val: false },
					{ test: 666, val: false },
					{ test: 13.666, val: false },
					{ test: {}, val: false },
					{ test: [], val: false },
					{ test: function(){}, val: false },
					{ test: undef, val: false },
					{ test: null, val: false },
					{ test: NaN, val: false }
				];

				assertIsExpected( assert.is.bool, assert.is.not.bool, 'boolean', expected );
			});
		});

		test('when calling .is.string() and .is.not.string()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: 'foo', val: true },
					{ test: '', val: true },
					{ test: true, val: false },
					{ test: 666, val: false },
					{ test: 13.666, val: false },
					{ test: {}, val: false },
					{ test: [], val: false },
					{ test: function(){}, val: false },
					{ test: undef, val: false },
					{ test: null, val: false },
					{ test: NaN, val: false }
				];

				assertIsExpected( assert.is.string, assert.is.not.string, 'string', expected );
			});
		});

		test('when calling .is.emptyString() and .is.not.emptyString()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: 'foo', val: false },
					{ test: '', val: true },
					{ test: true, val: false },
					{ test: 666, val: false },
					{ test: 13.666, val: false },
					{ test: {}, val: false },
					{ test: [], val: false },
					{ test: function(){}, val: false },
					{ test: undef, val: false },
					{ test: null, val: false },
					{ test: NaN, val: false }
				];

				assertIsExpected( assert.is.emptyString, assert.is.not.emptyString, 'emptyString', expected );
			});
		});

		test('when calling .is.number() and .is.not.number()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: 666, val: true },
					{ test: 13.666, val: true },
					{ test: 'foo', val: false },
					{ test: '', val: false },
					{ test: true, val: false },
					{ test: {}, val: false },
					{ test: [], val: false },
					{ test: function(){}, val: false },
					{ test: undef, val: false },
					{ test: null, val: false },
					{ test: NaN, val: false }
				];

				assertIsExpected( assert.is.number, assert.is.not.number, 'number', expected );
			});
		});

		test('when calling .is.object() and .is.not.object()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: {}, val: true },
					{ test: 666, val: false },
					{ test: 13.666, val: false },
					{ test: 'foo', val: false },
					{ test: '', val: false },
					{ test: true, val: false },
					{ test: [], val: false },
					{ test: function(){}, val: false },
					{ test: undef, val: false },
					{ test: null, val: false },
					{ test: NaN, val: false }
				];

				assertIsExpected( assert.is.object, assert.is.not.object, 'object', expected );
			});
		});

		test('when calling .is.array() and .is.not.array()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: [], val: true },
					{ test: {}, val: false },
					{ test: 666, val: false },
					{ test: 13.666, val: false },
					{ test: 'foo', val: false },
					{ test: '', val: false },
					{ test: true, val: false },
					{ test: function(){}, val: false },
					{ test: undef, val: false },
					{ test: null, val: false },
					{ test: NaN, val: false }
				];

				assertIsExpected( assert.is.array, assert.is.not.array, 'array', expected );
			});
		});

		test('when calling .is.fn() and .is.not.fn()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: function(){}, val: true },
					{ test: [], val: false },
					{ test: {}, val: false },
					{ test: 666, val: false },
					{ test: 13.666, val: false },
					{ test: 'foo', val: false },
					{ test: '', val: false },
					{ test: true, val: false },
					{ test: undef, val: false },
					{ test: null, val: false },
					{ test: NaN, val: false }
				];

				assertIsExpected( assert.is.fn, assert.is.not.fn, 'function', expected );
			});
		});

		test('when calling .is.method() and .is.not.method()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: function(){}, val: true },
					{ test: [], val: false },
					{ test: {}, val: false },
					{ test: 666, val: false },
					{ test: 13.666, val: false },
					{ test: 'foo', val: false },
					{ test: '', val: false },
					{ test: true, val: false },
					{ test: undef, val: false },
					{ test: null, val: false },
					{ test: NaN, val: false }
				];

				assertIsExpected( assert.is.method, assert.is.not.method, 'method', expected );
			});
		});

		test('when calling .is.property() and .is.not.propery()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: 666, val: true },
					{ test: 13.666, val: true },
					{ test: 'foo', val: true },
					{ test: '', val: true },
					{ test: true, val: true },
					{ test: [], val: true },
					{ test: {}, val: true },
					{ test: undef, val: true },
					{ test: null, val: true },
					{ test: NaN, val: true },
					{ test: function(){}, val: false }
				];

				assertIsExpected( assert.is.property, assert.is.not.property, 'property', expected );
			});
		});

		test('when calling .is.undefined() and .is.not.undefined()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: undef, val: true },
					{ test: 666, val: false },
					{ test: 13.666, val: false },
					{ test: 'foo', val: false },
					{ test: '', val: false },
					{ test: true, val: false },
					{ test: [], val: false },
					{ test: {}, val: false },
					{ test: null, val: false },
					{ test: NaN, val: false },
					{ test: function(){}, val: false }
				];

				assertIsExpected( assert.is.undefined, assert.is.not.undefined, 'undefined', expected );
			});
		});

		test('when calling .is.null() and .is.not.null()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: null, val: true },
					{ test: undef, val: false },
					{ test: 666, val: false },
					{ test: 13.666, val: false },
					{ test: 'foo', val: false },
					{ test: '', val: false },
					{ test: true, val: false },
					{ test: [], val: false },
					{ test: {}, val: false },
					{ test: NaN, val: false },
					{ test: function(){}, val: false }
				];

				assertIsExpected( assert.is.null, assert.is.not.null, 'null', expected );
			});
		});

		test('when calling .is.nullOrUndefined() and .is.not.nullOrUndefined()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: null, val: true },
					{ test: undef, val: true },
					{ test: 666, val: false },
					{ test: 13.666, val: false },
					{ test: 'foo', val: false },
					{ test: '', val: false },
					{ test: true, val: false },
					{ test: [], val: false },
					{ test: {}, val: false },
					{ test: NaN, val: false },
					{ test: function(){}, val: false }
				];

				assertIsExpected( assert.is.nullOrUndefined, assert.is.not.nullOrUndefined, 'nullOrUndefined', expected );
			});
		});

		test('when calling .is.NaN() and .is.not.NaN()', function() {
			testing.req.given( [ 'src/asserter' ], function ( assert ) {
				var undef;
				var expected = [
					{ test: NaN, val: true },
					{ test: null, val: true },
					{ test: undef, val: true },
					{ test: 666, val: false },
					{ test: 13.666, val: false },
					{ test: 'foo', val: true },
					{ test: '', val: true },
					{ test: true, val: true },
					{ test: [], val: true },
					{ test: {}, val: true },
					{ test: function(){}, val: true }
				];

				assertIsExpected( assert.is.NaN, assert.is.not.NaN, 'NaN', expected );
			});
		});
	</script>
</head>
<body>
	<h1 id="qunit-header">Asserter Module: Test Suite</h1>
	<h2 id="qunit-banner"></h2>
	<div id="qunit-testrunner-toolbar"></div>
	<h2 id="qunit-userAgent"></h2>
	<ol id="qunit-tests"></ol>
	<div id="qunit-fixture">
	</div>
</body>
</html>
